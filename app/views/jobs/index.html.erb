<div class="well hero">
	<h1>Plantões</h1>
       
</div>
<div class="container">
   <div class="row-fluid">

	   <div class="span10">
	 		<h3>Aqui você vai encontrar todos os plantões que estão disponiveis, plantões que foram cedidos por outros médicos, assim facilitando a manutenção do serviço nos hospitais e ajudando a evitar as faltas nos plantões e emergencias nos hospitais no Brasil.</h2>

	   </div> 
	   <div class="span2">
			<%= link_to 'Cadastrar Plantão', new_job_path ,:class => "btn huge btn-success" %>
		</div> 
	</div>
	<br clear="all" />
	<div class="row-fluid">
		<div class="span12 tabbable">
			<%= simple_form_for @job, :validate => true ,:html => {:class => 'form ',:novalidate => true },:method => 'get' do |f| %>
			<a href="#submitform" data-toggle="tab" class="btn">Filtrar: 
			   <b class="btn btn-small btn-primary" data-toggle="collapse" data-target="#hospitalform">Hospital</b>
			   <b class="btn btn-small btn-primary" data-toggle="collapse" data-target="#areaform">Especialidade</b>
			   <b class="btn btn-small btn-primary" data-toggle="collapse" data-target="#shiftform">Turno</b>
			   <b class="btn btn-small btn-primary" data-toggle="collapse" data-target="#priceform">Valor</b>
			   
			
		

			
				<b class="btn btn-small btn-group bordazero">
					<b class="btn btn-small btn-primary">	Dias da Semana:</b>	
					<b class=" clicavel btn btn-small btn-domingo" id="domingo" type="button">Domingo</b>
					<b class=" clicavel btn btn-small btn-segunda" id="segunda" type="button">Segunda</b>
					<b class=" clicavel btn btn-small btn-terca" id="terca" type="button">Terça</b>
					<b class=" clicavel btn btn-small btn-quarta" id="quarta" type="button">Quarta</b>
					<b class=" clicavel btn btn-small btn-quinta" id="quinta" type="button">Quinta</b>
					<b class=" clicavel btn btn-small btn-sexta" id="sexta" type="button">Sexta</b>
					<b class=" clicavel btn btn-small btn-sabado" id="sabado" type="button">Sábado</b>
				</b>
			</a>
		</div>
		<br clear="all"><br clear="all">
		<div class="span4">
			<div id="hospitalform" class="collapse out">

						<%= f.association :hospital , :prompt => "--- Hospital ---", :label => false, :class => "span3" %>
			</div>
		
			<div id="areaform" class="collapse out">
						<%= f.association :area , :prompt => "--- Especialidade ---", :label => false, :class => "span3" %>
			</div>
		
			<div id="shiftform" class="collapse out">
		    			<%= f.association :shift,:prompt => "--- Turno ---", :label => false, :class => "span3" %>
			</div>

			<div id="priceform" class="collapse out input-prepend">
		    			<span class="add-on">Maior que </span><%= f.text_field :price, :class => 'span3', :placeholder => "Valor" %>
			</div>
			
			<div class="tab-content">
				<div id="submitform" class="tab-pane">
					<%= f.button :submit, "Filtrar", :class => "btn btn-primary " %>
				</div>
			</div>
		</div>

		
		
		
		<% end %>
		
	</div>

	<br clear="all" />
	<ul class="thumbnails">
		<% @jobs.each do |job| %>
	    	<a href="<%=  job_path(job) %>">
	    		<li class="span3 white">
			        <table class="table table-condensed	caixa thumbnail" >
			        	<thead>
			        	<tr>
			        		<th colspan="2">
			        			<h4><%= job.area.name %> <br>(<%= job.hospital.city.name %> - <%= job.hospital.state.acronym %>) </h4>
			        		</th>
			        	</tr>
			        	 <tr>
			            	<th>Local:</th>
			            	<td><%=truncate(job.hospital.name, :ommision => "...", :length => 31) %></td>
			            </tr>
			            <tr>
			            	<th>Data:</th>
			            	<td><%= job.date.strftime("%d/%m/%Y") %> 

							<button class=" clicavel btn btn-mini btn-d<%= job.date.strftime('%w')%>"  type="button">
			            	
			            	<%= I18n.t("date."+job.date.strftime("%A"))%>
			            	</button>
			            	</td>
			            </tr>
						<tr>
							<th>Valor:</th>
							<td><%= to_real(job.price) %></td> 
						</tr>
						<tr>
							<th>Cedente:</th>
							<td><%= truncate(job.user.name,:ommision => "...", :length => 30) %></td> 
						</tr>
			            <tr>
			            
			            	<td colspan="2" id="job<%=job.id%>">
		            			<% if user_signed_in? %>
		            				<%= simple_form_for [:customer,@request],:html => {:class => 'form-inline'}, :remote => true  do |f| %>
		            					<div class="btn btn-info"><b><%=job.requests.count%></b> Candidato(s)</div>
				            			<% if !Request.where(:user_id => current_user.id,:job_id =>job.id).first %>
					            			<% if !job.request_id.nil? %>
					            				<div class="btn">Plantão Encerrado</div>
					            			<% elsif current_user.id != job.user_id  %>
				            				
				            					<%= f.hidden_field :job_id ,:value => job.id %>
				            					<%= f.submit "Pegar Plantão", :class => "btn btn-success" %>
				            				<% else %>	
				            					<div class="btn">Meu Plantão</div>
				            				<% end %>
				            			<% else  %>		
				            				<div class="btn btn-warning">Pleiteado</div>
				            			<% end %>	
				            		<% end %>
		            			<% end %>

			            	</td>
			             </tr>
			             </thead>
			        </table>
		    	</li>
			</a>
		<% end %>

	</ul>
	<%= will_paginate @jobs ,options = { :previous_label => "Anterior", :next_label => "Próximo", :class => "apple_pagination"} %>
</div> 